package com.szlazakm.ChatServer.pentest

import org.bouncycastle.jce.provider.BouncyCastleProvider
import spock.lang.Specification

import java.security.KeyPairGenerator
import java.security.Security
import java.security.Signature

class Helper extends Specification {

    static  {
        Security.removeProvider(BouncyCastleProvider.PROVIDER_NAME)
        Security.addProvider(BouncyCastleProvider())
    }

    def keyPairGenerator = KeyPairGenerator.getInstance(
            "ECDSA", "BC"
    )

    def signatureGenerator = Signature.getInstance(
    "SHA256withECDSA", "BC"
    )

    def "generate identity keys"() {

        when:
        def keyPair = keyPairGenerator.generateKeyPair()
        def privKeyBytes = keyPair.private.encoded
        def pubKeyBytes = keyPair.public.encoded

        then:
        print(privKeyBytes)
        print(pubKeyBytes)
    }

}
